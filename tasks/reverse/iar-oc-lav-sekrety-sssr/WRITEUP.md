# Яр_ОC_Лав: Секреты СССР

## Описание
> Добро пожаловать в мир тайн и загадок ЯрОсЛав, самой старой лотереи времен Советского Союза.<br/><br/> Вам предстоит проникнуть в глубины истории и раскроить секреты, хранящиеся в этой легендарной лотерее.<br/><br/>Вашей задачей будет восстановить детали прошлого, воскрешая ЯрОсЛав из пепла.<br/><br/> Перед вами старые архивы, старые билеты и таинственные шифры, которые стоят на пути.<br/><br/> Вам предстоит провести обратное инженерное исследование легендарных билетов, расшифровать их, и найти путь к воскрешению "ЯрОсЛав".<br/><br/>Цель миссии:<br/>1. Провести анализ архивов и исторических данных ЯрОсЛав.<br/>2. Расшифровать шифры на старых билетах и понять их структуру.<br/>3. Понять, какие механизмы использовались для случайного выбора выигрышных номеров.<br/>4. Восстановить программу, которая управляла лотереей.<br/>5. Раскрыть тайны и секреты ЯрОсЛав и воскресить ее дух в мире современных технологий.<br/><br/>Удачи, агент! Воскресите ЯрОсЛав и раскройте тайны СССР!<br><br><span style="color:#0077FF;"> nc elicot.punchclub.ru 2372 </span><br><br>Исходный код:<br><br><a href="lottery.zip" download>lottery</a>

Автор: [cornael](https://t.me/cornael)

nc localhost 2372

## Анализ файла
Проанализируем файл:
```
опр функ Лотерея()
тело

	пПиши("Введите число: ");

	Ввод = запись (цел64);
	колвоЦифр = 0;

	если Ввод > 0 то
		буффер = Ввод;
		нцПока буффер / 10 # 0 делай
			увел(колвоЦифр);
			буффер = буффер / 10;
		кц
		если колвоЦифр >= 6 и колвоЦифр <= 9 то
			если Ввод остОтДеленияНа(сум(разделитьНа(текст(Ввод)))) == 0 то
				если Ввод остОтДеленияНа(7) == 0 то
	                если не Ввод остОтДеленияНа(3) == 0 то
	                    если Ввод остОтДеленияНа(5) == 0 или Ввод остОтДеленияНа(11) == 0 то
	                    	если (Ввод остОтДеленияНа(17) == 0 и Ввод остОтДеленияНа(19) == 0) или (Ввод остОтДеленияНа(23) == 0 или Ввод остОтДеленияНа(29) == 0) то
	                    		если Ввод остОтДеленияНа(89) == 0 то
	                    			если Ввод остОтДеленияНа(8) # 0 то
										пПиши("surctf_find_flag_on_server");
									кне
								кне
							кне
						кне
					кне
				кне
			кне
		кне
	кне
кно
```

Перед нами код ЯР-22, который повсеместно используется в ЯОС из таска под названием Яр_ОС_Лав. Код выглядит довольно несложно и мы можем его легко переписать на python. Сделаем скрипт который подберет и выведет первое число которое подходит под все условия:

```py
for num in range(100000, 100000000):
    if num > 0:
        num_str = str(num)
        if len(num_str) >= 6 and len(num_str) <= 9:
            sum_of_digits = sum(map(int, num_str))
            if num % sum_of_digits == 0:
                if num % 7 == 0:
                    if num % 3 != 0:
                        if num % 5 == 0 or num % 11 == 0:
                            if (num % 17 == 0 and num % 19 == 0) or (num % 23 == 0 or num % 29 == 0):
                                if num % 89 == 0:
                                    if num % 8 != 0:
                                        print(num)
                                        break
```

Вывод программы:

```bash
❯ python3 solver.py
315238
```

Введем данное число в netcat, чтобы проверить правильность отработки скрипта:

```bash
❯ nc elicot.punchclub.ru 2372
Введите число: 315238
surctf_a_k4k_3to_sk0mpil1t
```

Отлично, флаг получен.

`flag: surctf_a_k4k_3to_sk0mpil1t`
